#!/bin/bash

echo "--------------------------------------------------------------------"
cat << "EOF"
 _                       _              ___           _               _             
| | ___  __ _ _ __ _ __ (_)_ __   __ _ / _ \ _ __ ___| |__   ___  ___| |_ _ __ __ _ 
| |/ _ \/ _` | '__| '_ \| | '_ \ / _` | | | | '__/ __| '_ \ / _ \/ __| __| '__/ _` |
| |  __/ (_| | |  | | | | | | | | (_| | |_| | | | (__| | | |  __/\__ \ |_| | | (_| |
|_|\___|\__,_|_|  |_| |_|_|_| |_|\__, |\___/|_|  \___|_| |_|\___||___/\__|_|  \__,_|
                                 |___/                                              
EOF

echo "                       a distributed machine learning processing tool"
echo "--------------------------------------------------------------------"

echo "--------------------------------------------------------------------"
echo "Deploying learningOrchestra in swarm cluster..."
echo "--------------------------------------------------------------------"

docker stack deploy --compose-file=docker-compose.yml microservice

echo "--------------------------------------------------------------------"
echo "Updating portainer agent microservice in each cluster node..."
echo "--------------------------------------------------------------------"
docker service update --image portainer/agent  microservice_agent

echo "--------------------------------------------------------------------"
echo "End."
echo "--------------------------------------------------------------------"
